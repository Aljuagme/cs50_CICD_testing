{% extends "network/layout.html" %}
{% load static %}

{% block body %}
    {% if user.is_authenticated %}

        <h2>All Posts</h2>

        <div class="listing">
            <h3>New Post</h3>
            <form id="compose-form" onsubmit="send_email()" method="post">
                {% csrf_token %}
                <textarea id="compose-body" placeholder="Write a new post...."></textarea>
                <input type="submit" value="Post">
            </form>
        </div>

        {% for post in Posts %}
            <div class="listing">
                <h4>
                    <a href="{% url 'network:profile' post.author.id %}">
                    {{ post.author }}
                    </a>
                </h4>
            
                {% if user == post.author %}
                    <button onclick="editPost({{ post.id }})">Edit</button>
                {% endif %}
            
                <div class="post-body">
                    <p id="body-{{ post.id }}">{{ post.body }}</p>
                </div>
                <p class="created-at">{{ post.created }}</p>
                <button onclick="handlerLike(this)" data-post-id="{{ post.id }}">
                    {% if user in post.likes.all %}
                        Unlike
                    {% else %}
                        Like
                    {% endif %}
                </button>
                
                <p>Likes: {{ post.likes.count }}</p>
                <p>Comment</p>
            </div>
        {% endfor %}

    {% endif %}

    <div class="pagination">
    <span class="step-links">
        {% if Posts.has_previous  %}
            <a href="?page={{ Posts.previous_page_number }}">Previous</a>
        {% endif %}
        <span class="current">
        Page {{ Posts.number }} of {{ Posts.paginator.num_pages }}
        </span>
    {% if Posts.has_next %}
        <a href="?page={{ Posts.next_page_number }}">Next</a>
    {% endif %}
    </span>
</div>

{% endblock %}

